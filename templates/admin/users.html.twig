{% extends 'base.html.twig' %}

{% block title %}User List
{% endblock %}

{% block body %}
	<div class="container fade-in">
		<h2 class="my-4">Registered Users</h2>

		<div class="card shadow-sm">
			<div class="card-body p-0">
				<table class="table table-hover table-borderless">
					<thead class="bg-light">
						<tr>
							<th scope="col" class="ps-4">ID</th>
							<th scope="col">Email</th>
							<th scope="col">Username</th>
							<th scope="col">Roles</th>
							<th scope="col">Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for user in users %}
							<tr>
								<td class="ps-4">{{ user.id }}</td>
								<td>{{ user.email }}</td>
								<td>{{ user.username }}</td>
								<td>{{ user.roles|join(', ') }}</td>
								<td>
									{% if user != app.user %}
										<form method="post" action="{{ path('admin_user_delete', {'id': user.id}) }}" onsubmit="return confirm('Are you sure you want to delete this user?')" class="d-inline">
											<input type="hidden" name="_token" value="{{ csrf_token('delete-user' ~ user.id) }}">
											<button class="btn btn-danger btn-sm rounded-pill">
												<i class="bi bi-trash"></i>
												Delete
											</button>
										</form>
									{% else %}
										<h5>
											<span class="text-muted small">Current user</span>
										</h5>
									{% endif %}
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
{% endblock %}